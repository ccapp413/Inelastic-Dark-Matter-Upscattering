#!/usr/bin/python

import matplotlib.pyplot as plt

xenon1tdelta=[0.16648508284554000,11.442005926100300,30.28880509192170,52.03594432493390,74.10588862593000,97.30400705454410,128.0744152582330,164.16258559627600,185.26876737485800,200.89803496692500,213.30623090145900,224.91158640762900,231.2013544023390,233.94471704026100,236.36699407946300,238.30852774152900,238.63800839606700,238.6513595691750,238.7110352671580,238.7110352671580]
xenon1tlimit=[10**x for x in [-45.25400505692540,-45.20578321572110,-45.047130483948000,-44.750363575032800,-44.36380446397820,-43.88746242243210,-43.16254193524240,-42.1199432642573,-41.36728200627670,-40.669816723119800,-39.91705533134090,-38.818915780226900,-37.74143716949740,-37.043823539972500,-36.20115126895990,-35.020011925025100,-34.018445859391600,-32.194898132403500,-24.044192382987200,-23]]

#upscattereddelta=[0.4295532646048060,79.89690721649490,257.3024054982820,272.1219931271480,300.4725085910650,315.7216494845360,341.06529209622,370.4896907216500,381.6580756013750]
#upscatteredlimit=[10**x for x in [-39.948453608247400,-38.907216494845400,-36.18900343642610,-35.817869415807600,-35.09621993127150,-34.65635738831620,-33.74226804123710,-32.776632302405500,-32.065292096219900]]
upscattereddelta=[0,5.934298834334150,19.49841045566940,33.06252207700460,46.34404803956200,62.027552101730800,73.89614977039920,87.8841398799011,102.57859413634800,115.15365595196000,129.14164606146200,142.84705051218600,157.11762628046600,171.52949487813500,180.28965030024700,186.64782762274800,201.34228187919500,212.50441540091800,217.73225008830800,235.39385376192200,256.0226068527020,275.52101730837200,279.61850936065000,293.8890851289300,301.51889791593100,312.5397386082660,319.7456729071,329.7774637937130,336.5595196043800,338.82020487460300]
upscatteredlimit=[10**x for x in [-39.88979159307670,-39.73719533733660,-39.5083009537266,-39.41222182974210,-39.265277287177700,-39.01095019427760,-38.92052278346870,-38.76227481455320,-38.5107735782409,-38.40904274108090,-38.24231720240200,-38.01059696220420,-37.87495584599080,-37.66301660190750,-37.51042034616740,-37.43412221829740,-37.21935711762630,-37.00741787354290,-36.91699046273400,-36.55245496291060,-36.049452490286100,-35.586012009890500,-35.49275874249380,-35.19886965736490,-35.00953726598380,-34.70999646767930,-34.430236665489200,-33.9413634758036,-33.11903920876020,-32.002825856587800]]
upscattereddelta=[0*1.0224948875255600,18.813905930470300,33.946830265848700,59.509202453987700,79.95910020449900,99.18200408997960,118.20040899795500,137.8323108384460,154.80572597137000,171.16564417177900,201.22699386503100,225.76687116564400,249.48875255623700,261.758691206544,275.86912065439700,292.2290388548060,307.97546012269900,320.44989775051100,330.67484662576700,338.6503067484660,340.2862985685070,341.30879345603300,341.5132924335380,341.5132924335380]
upscatteredlimit=[10**x for x in [-39.39301042305330,-39.163090128755400,-38.97915389331700,-38.6020846106683,-38.31698344573880,-38.03188228080930,-37.76517473942370,-37.470876762722300,-37.194972409564700,-36.90987124463520,-36.33966891477620,-35.78786020846110,-35.226854690374000,-34.9325567136726,-34.66584917228690,-34.38074800735750,-34.10484365419990,-33.81974248927040,-33.50705088902510,-33.15757204169220,-32.85407725321890,-32.348252605763300,-30.33415082771310,-23.988350705088900]]
upscattereddelta=[0.9832036050798900,5.079885292912740,10.979106923392100,19.00860303154450,25.64522736583370,43.99836132732490,59.07414993854980,80.29496108152400,98.32036050798850,104.79311757476400,117.90249897583000,137.32077017615700,169.19295370749700,192.62597296190100,221.05694387546100,247.1937730438350,262.2695616550590,276.3621466612040,304.46538303973800,318.55796804588300,331.9131503482180,336.09176566980700,339.6149119213440,340.84391642769400,341.5813191315040]
upscatteredlimit=[10**x for x in [-39.47263142804530,-39.42682698311880,-39.40398784847970,-39.25667509448410,-39.178146860937800,-38.939260116736600,-38.77240356019360,-38.513904556444300,-38.27828898304040,-38.19320498495830,-38.02303967338230,-37.764511139162100,-37.306317695248800,-36.92006987446330,-36.3733534749042,-35.813493331214300,-35.50574555579840,-35.26023593235480,-34.765938803199800,-34.51059955983490,-34.196270516294600,-33.89162075573310,-33.560747937028200,-33.275709093720600,-25.76916809442020]]

upscattereddelta100=[0,9.137635636778980,23.300970873786400,36.55054254711590,51.62764134780130,63.04968589377500,76.75613934894350,92.29011993146770,104.62592804111900,116.50485436893200,130.66818960593900,137.97829811536300,157.62421473443700,172.24443175328400,186.40776699029100,200.11422044546000,209.2518560822390,215.648201027984,231.18218161050800,245.80239862935500,261.3363792118790,269.56025128498,275.95659623072500,290.57681324957200,304.7401484865790,317.0759565962310,330.3255282695600,351.34209023415200,367.33295259851500,379.2118789263280,403.42661336379200,417.5899486008000,429.9257567104510,443.63221016562000,455.5111364934320,470.1313535122790,494.80296973158200,513.07824100514,545.5168475157050,570.1884637350090,582.0673900628210,594.8600799543120,606.7390062821250,620.9023415191320,633.6950314106230,647.85836664763,662.4785836664760,680.7538549400340,699.0291262135920,750.1998857795550,779.4403198172470]
upscatteredlimit100=[10**x for x in [-38.70253807106600,-38.525888324873100,-38.41624365482230,-38.27005076142130,-38.014213197969500,-37.92893401015230,-37.776649746192900,-37.52081218274110,-37.42335025380710,-37.30761421319800,-37.118781725888300,-37.00913705583760,-36.789847715736000,-36.54010152284260,-36.36954314720810,-36.1746192893401,-36.02233502538070,-35.91878172588830,-35.64467005076140,-35.4253807106599,-35.15736040609140,-35.02335025380710,-34.93197969543150,-34.712690355330000,-34.51776649746190,-34.38984771573600,-34.26802030456850,-34.018274111675100,-33.920812182741100,-33.79898477157360,-33.51269035533000,-33.421319796954300,-33.30558375634520,-33.14720812182740,-33.01319796954320,-32.91573604060910,-32.80609137055840,-32.72690355329950,-32.51370558375640,-32.39187817258880,-32.31269035533000,-32.19086294416240,-32.008121827411200,-31.916751269035500,-31.776649746192900,-31.51472081218270,-31.338071065989800,-31.01522842639590,-30.497461928934000,-29.047715736040600,-28]]

projectiondelta=[0.007687874023076800,9.420955735143340,43.634984866633500,71.8811950116802,112.07041067555300,149.0458814457220,204.166550102836,229.65868615514300,245.27478704055100,259.2831612708820,270.0768296232580,284.5455153107220,298.0968881407920,309.3526831427770,327.0448303425010,339.45636907262200,350.0372328009980,350.55071872012300,350.55071872012300]
projectionlimit=[10**x for x in [-44.59813944906560,-44.54780181258710,-44.11207105133170,-43.62617434945100,-42.85549316750870,-42.07368506923040,-40.806093024557000,-40.2811572983871,-39.99633181633070,-39.75059404843230,-39.543961933064700,-39.23682367796860,-38.879463104504500,-38.51654676074630,-37.71262833677760,-36.936675835880100,-35.8537670262385,-33.012831061744500,-23]]

upscattereddelta2=[9.437280187573270,41.13423212192260,90.98769050410320,149.25263774912100,173.76905041031700,209.36400937866400,239.11195779601400,275.9378663540450,294.9150058616650,311.32766705744400,320.86752637749100,331.4331770222740,339.84466588511100,345.7942555685820,349.7948417350530]
upscatteredlimit2=[10**x for x in [-39.99532321027610,-39.586623210798700,-38.96407923089390,-38.246495804511300,-37.954240343930800,-37.46473472701020,-37.027492513966100,-36.098173564501800,-35.65372594583580,-35.30673490468920,-35.05479376172550,-34.6887436876055,-34.329811224783100,-33.961352380985600,-33.60476737116970]]

upscattereddeltamar31=[-0.09705472950250990,10.253321357574300,20.594758193249600,41.28912518783070,51.28703936250370,61.62975323409340,81.96271906486920,91.9580791677131,102.30079303930300,122.99005189022600,132.9828579212410,143.31790957734400,153.3004993210430,164.00972250009600,173.98975817196600,184.32225575623900,202.13818379952200,214.9736717762290,224.9498763403560,235.63355880111900,245.9749956367940,265.92740476504700,276.6276886926980,296.9517152720730,307.29570617957700,327.9415458094070,332.5439832452890,336.7441543681010,337.5461329224120,337.5461329224120]
upscatteredlimitmar31=[10**x for x in [-39.46428343386440,-39.357387014247500,-39.20049038179120,-38.95098310481490,-38.87264972181900,-38.72289597691120,-38.45195152371670,-38.35933236562390,-38.20957862071610,-37.93149979354590,-37.82459486035610,-37.631983790157500,-37.46793575657990,-37.36819073808420,-37.18985692940970,-36.9829600841141,-36.63338427287700,-36.42654702259080,-36.22678455127090,-35.98418178180560,-35.82728514934940,-35.42776020670950,-35.27801497537450,-34.957070309340700,-34.81445945198130,-34.29352244816300,-34.03648917286380,-33.52944631979530,-32.0151797002371,-27]]

upscattereddeltajun13=[0.13487351592356200,1.4094547249548800,4.8511610527494600,10.33205285924700,23.589479054054200,37.483906941882800,49.593487769826100,61.83105638974540,69.60648328399370,81.33417126838470,89.1097426183801,96.50342112482320,108.74060452941700,115.7517642174030,120.34073808907300,133.85288791802400,146.34566169124400,168.01619060014100,180.63627803851700,201.9252993191870,219.39004730169000,242.7191207955470,255.84990745201800,267.70524616497500,283.63958181024200,293.327313885279,315.38233584117700,322.65028969568300,328.5167820432430,330.68621845396000,332.0311014599390]
upscatteredlimitjun13=[10**x for x in [-39.47298828862860,-39.47298828862860,-39.4333207404609,-39.41065357007930,-39.20098224404990,-39.025311673592700,-38.90064223649410,-38.71363808084620,-38.656970154892300,-38.475632791839800,-38.401964488099700,-38.27162825840570,-38.12995844352100,-38.01662259161320,-37.95995466565920,-37.772950510011300,-37.551945598791100,-37.24027200604460,-37.036267472610500,-36.62259161314700,-36.271250472232700,-35.77257272383830,-35.46656592368720,-35.26256139025310,-35.0188893086513,-34.911220249338900,-34.35020778239520,-34.01586701926710,-33.613524744994300,-33.30185115224780,-25.028333962977000]]

upscattereddeltajun24=[1.0110294117647100,6.617647058823530,10.569852941176500,22.79411764705880,30.147058823529400,34.9264705882353,38.419117647058800,41.084558823529400,43.933823529411800,50.183823529411800,59.283088235294100,63.051470588235300,71.04779411764700,82.53676470588240,87.22426470588230,90.80882352941180,99.26470588235290,105.51470588235300,114.43014705882400,121.59926470588200,125.18382352941200,131.1580882352940,137.9595588235290,140.625,149.9080882352940,156.80147058823500,160.3860294117650,165.16544117647100,176.83823529411800,187.13235294117600,200.73529411764700,211.76470588235300,223.0698529411760,233.36397058823500,241.36029411764700,251.19485294117600,260.2022058823530,265.8088235294120,271.41544117647100,279.8713235294120,289.3382352941180,297.1507352941180,301.01102941176500,310.7536764705880,319.02573529411800,326.56250000000000,331.43382352941200,337.7757352941180,339.797794117647,340.71691176470600,341.3602941176470]
upscatteredlimitjun24=[10**x for x in [-39.47166313559320,-39.41207627118640,-39.396186440678000,-39.217425847457600,-39.13797669491530,-39.066472457627100,-39.01085805084750,-38.98702330508480,-38.93935381355930,-38.89565677966100,-38.75662076271190,-38.712923728813600,-38.641419491525400,-38.47854872881360,-38.42690677966100,-38.39512711864410,-38.25609110169490,-38.18061440677970,-38.077330508474600,-37.98199152542370,-37.934322033898300,-37.87473516949150,-37.755561440678000,-37.72378177966100,-37.5489936440678,-37.465572033898300,-37.429819915254200,-37.35037076271190,-37.17161016949150,-37.000794491525400,-36.74258474576270,-36.528072033898300,-36.31753177966100,-36.114936440678000,-35.96398305084750,-35.72563559322030,-35.51509533898310,-35.40783898305090,-35.33633474576270,-35.18935381355930,-35.03840042372880,-34.94703389830510,-34.91128177966100,-34.68087923728810,-34.48225635593220,-34.27171610169490,-34.01747881355930,-33.60434322033900,-33.29846398305090,-33.02833686440680,-25.019862288135600]]
upscattereddeltajun24=[1.0110294117647100,6.617647058823530,10.569852941176500,22.79411764705880,30.147058823529400,34.9264705882353,38.419117647058800,41.084558823529400,43.933823529411800,50.183823529411800,59.283088235294100,63.051470588235300,71.04779411764700,82.53676470588240,87.22426470588230,90.80882352941180,99.26470588235290,105.51470588235300,114.43014705882400,121.59926470588200,125.18382352941200,131.1580882352940,137.9595588235290,140.625,149.9080882352940,156.80147058823500,160.3860294117650,165.16544117647100,176.83823529411800,187.13235294117600,200.73529411764700,211.76470588235300,223.0698529411760,233.36397058823500,241.36029411764700,251.19485294117600,260.2022058823530,265.8088235294120,271.41544117647100,279.8713235294120,289.3382352941180,297.1507352941180,301.01102941176500,310.7536764705880,319.02573529411800,326.56250000000000,331.43382352941200,337.7757352941180,339.797794117647,340.71691176470600,341.3602941176470]
upscatteredlimitjun24=[10**x for x in [-39.47166313559320,-39.41207627118640,-39.396186440678000,-39.217425847457600,-39.13797669491530,-39.066472457627100,-39.01085805084750,-38.98702330508480,-38.93935381355930,-38.89565677966100,-38.75662076271190,-38.712923728813600,-38.641419491525400,-38.47854872881360,-38.42690677966100,-38.39512711864410,-38.25609110169490,-38.18061440677970,-38.077330508474600,-37.98199152542370,-37.934322033898300,-37.87473516949150,-37.755561440678000,-37.72378177966100,-37.5489936440678,-37.465572033898300,-37.429819915254200,-37.35037076271190,-37.17161016949150,-37.000794491525400,-36.74258474576270,-36.528072033898300,-36.31753177966100,-36.114936440678000,-35.96398305084750,-35.72563559322030,-35.51509533898310,-35.40783898305090,-35.33633474576270,-35.18935381355930,-35.03840042372880,-34.94703389830510,-34.91128177966100,-34.68087923728810,-34.48225635593220,-34.27171610169490,-34.01747881355930,-33.60434322033900,-33.29846398305090,-33.02833686440680,-25.019862288135600]]

#maxsigmadelta=[1,10,50,100,150,200,250,300,350,400,450,500,550,600,650,700,750,800]
#maxsigma1km=[10**x for x in [-30.9,-30.28,-29.22,-28.68,-28.35,-28.04,-27.61,-27.15,-27.04,-26.94,-26.69,-26.22,-26.06,-25.92,-25.36,-25.11,-24.5,-23.68]]
#maxsigmadelta=[1.4314928425357900,11.451942740286300,21.26789366053170,32.10633946830270,51.32924335378320,71.77914110429450,102.04498977505100,144.98977505112500,210.83844580777100,341.5132924335380]
#maxsigma1km=[10**x for x in [-27.354383813611300,-26.51747394236670,-25.947271612507700,-25.680564071122000,-25.39546290619250,-25.11036174126300,-24.83445738810550,-24.558553034947900,-24.264255058246500,-23.988350705088900]]
#maxsigmadelta=[1.310938140106520,11.552642359688700,50.71691929537080,72.10159770585830,102.17124129455100,145.3502662843100,210.40557148709500,341.4993854977470]
#maxsigma1km=[10**x for x in [-28.751798002988500,-28.014744295652600,-27.038977000058500,-26.767374521002300,-26.518850104940600,-26.27381699591350,-26.0193126594981,-25.76916675212610]]

maxsigmadelta=[0.08339911802199750,30.545938165786200,49.5669079123503,69.70740969933670,99.53477682687680,141.72548537818900,187.10274325591100,220.4988414649080,247.01229744896700,274.29045400652800,292.64639764512400,331.77618521813200]
maxsigma1km=[10**x for x in [-30.530789573101600,-30.525122780506200,-27.02871174915000,-26.779372874952800,-26.524367208160200,-26.280695126558400,-26.025689459765800,-25.782017378164000,-25.52701171137140,-25.27767283717420,-25.045334340763100,-25.028333962977000]]
maxsigmadelta=[1.102941176470590,31.341911764705900,51.011029411764700,71.96691176470590,102.11397058823500,145.7720588235290,192.46323529411800,226.93014705882300,235.8455882352940,253.86029411764700,268.84191176470600,282.0772058823530,341.3602941176470]
maxsigma1km=[10**x for x in [-30.5177436440678,-30.5177436440678,-27.02198093220340,-26.771716101694900,-26.517478813559300,-26.27118644067800,-26.016949152542400,-25.77462923728810,-25.659427966101700,-25.520391949152500,-25.33368644067800,-25.27012711864410,-25.023834745762700]]

tantalumx=[-0.2591670499881080,70.80200389108540,133.19647117572000,207.43351237576400,258.85007150361600,340.59561885977200,476.64274860259200,546.2521903016400,569.935190339226,584.9527395997590,594.7711973768290]
tantalumy=[10**x for x in [-28.052044609665400,-27.853779429987600,-27.63073110285010,-27.308550185873600,-27.048327137546500,-26.565055762081800,-25.561338289962800,-24.855018587360600,-24.50805452292440,-24.223048327137500,-23.987608426270100]]

plt.xlabel("$\delta$ [keV]",size=14)
plt.ylabel("$\sigma_p$ [cm$^2$]",size=14)

plt.yscale("log")
plt.ylim([10**-46,10**-24])
plt.xlim([0,400])

plt.plot(maxsigmadelta,maxsigma1km,"r--")
plt.plot(upscattereddeltajun24,upscatteredlimitjun24,"r-",label="This Work")
plt.fill_between(upscattereddeltajun24,upscatteredlimitjun24,1,facecolor="red",alpha=0.4)
plt.fill_between(maxsigmadelta,maxsigma1km,1,facecolor="white",alpha=0.4)
#plt.plot(upscattereddelta,upscatteredlimit)
#plt.plot(upscattereddelta100,upscatteredlimit100,"r-")
plt.plot(xenon1tdelta,xenon1tlimit,"k-",label="Xenon1T Limit")
plt.fill_between(xenon1tdelta,xenon1tlimit,1,facecolor="gray",alpha=0.4)
plt.plot(projectiondelta,projectionlimit,"k:",label="LUX/Panda-X Projection (500 keV)")
#plt.plot(upscattereddelta2,upscatteredlimit2)

plt.plot(tantalumx,tantalumy,"b-",label="Tantalum")
plt.fill_between(tantalumx,tantalumy,1,facecolor="blue",alpha=0.3)

#plt.plot(upscattereddeltamar31,upscatteredlimitmar31)

plt.tick_params(direction="in",length=10,labelsize=14)
plt.tick_params(which="minor",direction="in",length=4)

plt.legend(loc=4,fontsize=9)
plt.tight_layout()
plt.savefig("inelasticxenonlimits.pdf")
plt.show()
