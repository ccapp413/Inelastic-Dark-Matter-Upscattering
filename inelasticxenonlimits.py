#!/usr/bin/python

import matplotlib.pyplot as plt

xenon1tdelta=[0.16648508284554000,11.442005926100300,30.28880509192170,52.03594432493390,74.10588862593000,97.30400705454410,128.0744152582330,164.16258559627600,185.26876737485800,200.89803496692500,213.30623090145900,224.91158640762900,231.2013544023390,233.94471704026100,236.36699407946300,238.30852774152900,238.63800839606700,238.6513595691750,238.7110352671580,238.7110352671580]
xenon1tlimit=[10**x for x in [-45.25400505692540,-45.20578321572110,-45.047130483948000,-44.750363575032800,-44.36380446397820,-43.88746242243210,-43.16254193524240,-42.1199432642573,-41.36728200627670,-40.669816723119800,-39.91705533134090,-38.818915780226900,-37.74143716949740,-37.043823539972500,-36.20115126895990,-35.020011925025100,-34.018445859391600,-32.194898132403500,-24.044192382987200,-23]]

projectiondelta=[0.007687874023076800,9.420955735143340,43.634984866633500,71.8811950116802,112.07041067555300,149.0458814457220,204.166550102836,229.65868615514300,245.27478704055100,259.2831612708820,270.0768296232580,284.5455153107220,298.0968881407920,309.3526831427770,327.0448303425010,339.45636907262200,350.0372328009980,350.55071872012300,350.55071872012300]
projectionlimit=[10**x for x in [-44.59813944906560,-44.54780181258710,-44.11207105133170,-43.62617434945100,-42.85549316750870,-42.07368506923040,-40.806093024557000,-40.2811572983871,-39.99633181633070,-39.75059404843230,-39.543961933064700,-39.23682367796860,-38.879463104504500,-38.51654676074630,-37.71262833677760,-36.936675835880100,-35.8537670262385,-33.012831061744500,-23]]

upscattereddeltajun24=[1.0110294117647100,6.617647058823530,10.569852941176500,22.79411764705880,30.147058823529400,34.9264705882353,38.419117647058800,41.084558823529400,43.933823529411800,50.183823529411800,59.283088235294100,63.051470588235300,71.04779411764700,82.53676470588240,87.22426470588230,90.80882352941180,99.26470588235290,105.51470588235300,114.43014705882400,121.59926470588200,125.18382352941200,131.1580882352940,137.9595588235290,140.625,149.9080882352940,156.80147058823500,160.3860294117650,165.16544117647100,176.83823529411800,187.13235294117600,200.73529411764700,211.76470588235300,223.0698529411760,233.36397058823500,241.36029411764700,251.19485294117600,260.2022058823530,265.8088235294120,271.41544117647100,279.8713235294120,289.3382352941180,297.1507352941180,301.01102941176500,310.7536764705880,319.02573529411800,326.56250000000000,331.43382352941200,337.7757352941180,339.797794117647,340.71691176470600,341.3602941176470]
upscatteredlimitjun24=[10**x for x in [-39.47166313559320,-39.41207627118640,-39.396186440678000,-39.217425847457600,-39.13797669491530,-39.066472457627100,-39.01085805084750,-38.98702330508480,-38.93935381355930,-38.89565677966100,-38.75662076271190,-38.712923728813600,-38.641419491525400,-38.47854872881360,-38.42690677966100,-38.39512711864410,-38.25609110169490,-38.18061440677970,-38.077330508474600,-37.98199152542370,-37.934322033898300,-37.87473516949150,-37.755561440678000,-37.72378177966100,-37.5489936440678,-37.465572033898300,-37.429819915254200,-37.35037076271190,-37.17161016949150,-37.000794491525400,-36.74258474576270,-36.528072033898300,-36.31753177966100,-36.114936440678000,-35.96398305084750,-35.72563559322030,-35.51509533898310,-35.40783898305090,-35.33633474576270,-35.18935381355930,-35.03840042372880,-34.94703389830510,-34.91128177966100,-34.68087923728810,-34.48225635593220,-34.27171610169490,-34.01747881355930,-33.60434322033900,-33.29846398305090,-33.02833686440680,-25.019862288135600]]

maxsigmadelta=[1.102941176470590,31.341911764705900,51.011029411764700,71.96691176470590,102.11397058823500,145.7720588235290,192.46323529411800,226.93014705882300,235.8455882352940,253.86029411764700,268.84191176470600,282.0772058823530,341.3602941176470]
maxsigma1km=[10**x for x in [-30.5177436440678,-30.5177436440678,-27.02198093220340,-26.771716101694900,-26.517478813559300,-26.27118644067800,-26.016949152542400,-25.77462923728810,-25.659427966101700,-25.520391949152500,-25.33368644067800,-25.27012711864410,-25.023834745762700]]

tantalumx=[-0.2591670499881080,70.80200389108540,133.19647117572000,207.43351237576400,258.85007150361600,340.59561885977200,476.64274860259200,546.2521903016400,569.935190339226,584.9527395997590,594.7711973768290]
tantalumy=[10**x for x in [-28.052044609665400,-27.853779429987600,-27.63073110285010,-27.308550185873600,-27.048327137546500,-26.565055762081800,-25.561338289962800,-24.855018587360600,-24.50805452292440,-24.223048327137500,-23.987608426270100]]

plt.xlabel("$\delta$ [keV]",size=14)
plt.ylabel("$\sigma_p$ [cm$^2$]",size=14)

plt.yscale("log")
plt.ylim([10**-46,10**-24])
plt.xlim([0,400])

plt.plot(maxsigmadelta,maxsigma1km,"r--")
plt.plot(upscattereddeltajun24,upscatteredlimitjun24,"r-",label="This Work")
plt.fill_between(upscattereddeltajun24,upscatteredlimitjun24,1,facecolor="red",alpha=0.4)
plt.fill_between(maxsigmadelta,maxsigma1km,1,facecolor="white",alpha=0.4)
plt.plot(xenon1tdelta,xenon1tlimit,"k-",label="Xenon1T Limit")
plt.fill_between(xenon1tdelta,xenon1tlimit,1,facecolor="gray",alpha=0.4)
plt.plot(projectiondelta,projectionlimit,"k:",label="LUX/Panda-X Projection (500 keV)")

plt.plot(tantalumx,tantalumy,"b-",label="Tantalum")
plt.fill_between(tantalumx,tantalumy,1,facecolor="blue",alpha=0.3)

plt.tick_params(direction="in",length=10,labelsize=14)
plt.tick_params(which="minor",direction="in",length=4)

plt.legend(loc=4,fontsize=9)
plt.tight_layout()
plt.savefig("inelasticxenonlimits.pdf")
plt.show()
