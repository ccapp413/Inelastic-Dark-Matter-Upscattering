#!/usr/bin/python

import matplotlib.pyplot as plt

xenon1tdelta=[0.16648508284554000,11.442005926100300,30.28880509192170,52.03594432493390,74.10588862593000,97.30400705454410,128.0744152582330,164.16258559627600,185.26876737485800,200.89803496692500,213.30623090145900,224.91158640762900,231.2013544023390,233.94471704026100,236.36699407946300,238.30852774152900,238.63800839606700,238.6513595691750,238.7110352671580]
xenon1tlimit=[10**x for x in [-45.25400505692540,-45.20578321572110,-45.047130483948000,-44.750363575032800,-44.36380446397820,-43.88746242243210,-43.16254193524240,-42.1199432642573,-41.36728200627670,-40.669816723119800,-39.91705533134090,-38.818915780226900,-37.74143716949740,-37.043823539972500,-36.20115126895990,-35.020011925025100,-34.018445859391600,-32.194898132403500,-24.044192382987200]]

projectiondelta=[0.007687874023076800,9.420955735143340,43.634984866633500,71.8811950116802,112.07041067555300,149.0458814457220,204.166550102836,229.65868615514300,245.27478704055100,259.2831612708820,270.0768296232580,284.5455153107220,298.0968881407920,309.3526831427770,327.0448303425010,339.45636907262200,350.0372328009980,350.55071872012300,350.55071872012300]
projectionlimit=[10**x for x in [-44.59813944906560,-44.54780181258710,-44.11207105133170,-43.62617434945100,-42.85549316750870,-42.07368506923040,-40.806093024557000,-40.2811572983871,-39.99633181633070,-39.75059404843230,-39.543961933064700,-39.23682367796860,-38.879463104504500,-38.51654676074630,-37.71262833677760,-36.936675835880100,-35.8537670262385,-33.012831061744500,-28]]

songdelta=[0,72.24611313264970,145.2861395964270,186.76811114786600,246.90704598081400,335.62686073437000,397.15514389679100,433.2782004631160,462.0575587165070,486.47039364869300,511.081706913662,529.9371485279520,545.0215018193850,555.7393317896130,563.8769434336750,570.2282500826990,575.1902084022490,589.6791266953360,601.389348329474,610.1223949718820,619.0539199470730,625.8021832616610,630.1687065828650,632.9474032418130,634.9321865696330,635.7260999007610,636.9169698974530,636.9169698974530]
songlimit=[10**x for x in [-37.83306751727800,-37.50235330303930,-37.171650343995700,-36.96809169748220,-36.62869972774740,-36.04303564573080,-35.55055332474070,-35.21082088535120,-34.90500879048330,-34.59062867827250,-34.18268412839860,-33.757645750820900,-33.255998887142600,-32.71175955104430,-32.056904156561200,-31.30845618642680,-30.474927382008200,-30.160406579857500,-29.820328043215700,-29.471701185822700,-28.9614609806124,-28.306585889537600,-27.634664805338800,-26.97973343828800,-26.22271745081080,-25.652819083464800,-24.045180463865300,-20]]

combineddddelta=[0,13.09956996361230,24.214356599404600,38.50479655970890,57.95567317234540,77.0095931194178,94.67416473701620,114.32351968243500,129.01091630830300,146.67548792590100,162.35527621568000,182.9970228250080,197.48594111809500,207.80681442275900,214.35659940456500,220.31094938802500,243.92987098908400,277.67118756202500,302.6794574925570,324.5120740985780,343.1690373800860,365.9940456500170,382.467747270923,392.5901422428050,401.52166721799500,407.4760172014560,411.8425405226600,416.60602050942800,421.5679788289780,423.75124048958000,425.9345021501820,427.52232881243800,427.72080714522,427.72080714522]
combinedddlimit=[10**x for x in [-45.2589048378522,-45.208053865957300,-45.11464418722810,-44.95323061912540,-44.66429850325250,-44.31581796339710,-43.95881161318080,-43.51677226325970,-43.142711478522900,-42.65811342176750,-42.19049945456270,-41.45926630548040,-40.847031521405200,-40.30278655770930,-39.86056149706760,-39.358785198644500,-38.98485103485370,-38.47496255449320,-38.075529745986100,-37.65903968915970,-37.22549238401390,-36.53682075556480,-35.86507131309260,-35.35484799067510,-34.81058333038760,-34.30880703196460,-33.71344097168910,-33.22866001801180,-32.56525348897860,-32.08894206968620,-31.451014488777600,-30.56640116716370,-24.042214719931200,-20]]

picolmcdelta=[0.5433124849996600,56.97399233319340,108.18267615343900,184.35619574166200,235.89859314385900,278.24502991469700,294.33270192301300,328.4671072195920,360.62064989046700,396.0596936145960,443.32960096843900,503.0836473651450,522.7859442516640,533.9650623872280,538.9095693564880,538.9095693564880]
picolmclimit=[10**x for x in [-42.71720116618080,-42.43148688046650,-41.755102040816300,-40.48979591836740,-39.72594752186590,-39.15451895043730,-38.89795918367350,-38.518950437317800,-38.33819241982510,-38.06997084548110,-37.440233236151600,-36.48979591836740,-36.12827988338190,-35.70262390670550,-35.32361516034990,-20]]

upscattereddeltajun24=[1.0110294117647100,6.617647058823530,10.569852941176500,22.79411764705880,30.147058823529400,34.9264705882353,38.419117647058800,41.084558823529400,43.933823529411800,50.183823529411800,59.283088235294100,63.051470588235300,71.04779411764700,82.53676470588240,87.22426470588230,90.80882352941180,99.26470588235290,105.51470588235300,114.43014705882400,121.59926470588200,125.18382352941200,131.1580882352940,137.9595588235290,140.625,149.9080882352940,156.80147058823500,160.3860294117650,165.16544117647100,176.83823529411800,187.13235294117600,200.73529411764700,211.76470588235300,223.0698529411760,233.36397058823500,241.36029411764700,251.19485294117600,260.2022058823530,265.8088235294120,271.41544117647100,279.8713235294120,289.3382352941180,297.1507352941180,301.01102941176500,310.7536764705880,319.02573529411800,326.56250000000000,331.43382352941200,337.7757352941180,339.797794117647,340.71691176470600,341.3602941176470]
upscatteredlimitjun24=[10**x for x in [-39.47166313559320,-39.41207627118640,-39.396186440678000,-39.217425847457600,-39.13797669491530,-39.066472457627100,-39.01085805084750,-38.98702330508480,-38.93935381355930,-38.89565677966100,-38.75662076271190,-38.712923728813600,-38.641419491525400,-38.47854872881360,-38.42690677966100,-38.39512711864410,-38.25609110169490,-38.18061440677970,-38.077330508474600,-37.98199152542370,-37.934322033898300,-37.87473516949150,-37.755561440678000,-37.72378177966100,-37.5489936440678,-37.465572033898300,-37.429819915254200,-37.35037076271190,-37.17161016949150,-37.000794491525400,-36.74258474576270,-36.528072033898300,-36.31753177966100,-36.114936440678000,-35.96398305084750,-35.72563559322030,-35.51509533898310,-35.40783898305090,-35.33633474576270,-35.18935381355930,-35.03840042372880,-34.94703389830510,-34.91128177966100,-34.68087923728810,-34.48225635593220,-34.27171610169490,-34.01747881355930,-33.60434322033900,-33.29846398305090,-33.02833686440680,-25.019862288135600]]

upscattereddelta100dec21=[1.800932625824090,22.38301977809940,51.6481749477408,79.30535455861070,105.03296349895500,125.29345553947600,155.84499115613400,180.6078147612160,207.9433992603310,225.63113040681800,244.6052420003220,275.1567776169800,301.84917189258700,328.21997105644000,364.2386235729220,378.06721337835700,399.6140858658950,430.8088117060620,460.7171570992120,483.2288149220130,491.5902878276250,510.24280430937500,533.3976523556840,550.7637883904170,577.1345875542690,594.5007235890020,622.1579031998710,648.2071072519700,676.185881974594,697.0895642386240,716.7068660556360,735.6809776491400,758.192635471941,781.3474835182510,786.171410194565,791.6385270943880,794.532883100177,796.1408586589490,797.1056439942110,798.7136195529830]
upscatteredlimit100dec21=[10**x for x in [-37.49800022854540,-37.4408639012685,-37.09233230487950,-36.680950748486000,-36.27528282482010,-35.99531482116340,-35.69249228659590,-35.48108787567140,-35.258256199291600,-35.155410810193200,-34.98971546109020,-34.74974288652730,-34.52691121014750,-34.26979773740150,-34.00125699920010,-33.89841161010180,-33.75557079190960,-33.509884584618900,-33.281339275511400,-33.127071191863800,-33.08707576277000,-32.94994857730550,-32.87567135184560,-32.8013941263856,-32.7042623700149,-32.62998514455500,-32.418580733630500,-32.19574905725060,-31.9214946863216,-31.75008570449100,-31.510113129928000,-31.17300879899440,-30.68735001714090,-30.150268540738200,-29.91029596617530,-29.590332533424800,-29.29893726431270,-29.03039652611130,-28.773283053365300,-22.276882641983800]]

maxsigmadelta=[2.1225277375783900,22.704614889853700,23,124.65026531596700,165.49284450876300,205.69223347805100,230.7766521948870,264.222543817334,411.8347001125580,449.1397330760570,492.55507316288800,614.7612156295230,694.1952082328350,722.8171731789680,757.8710403601870,778.4531275124620,798.7136195529830]
maxsigma1km=[10**x for x in [-32.2643126499829,-30.515941035310300,-27.5,-26.522111758656200,-26.276425551365600,-26.030739344075000,-25.773625871329000,-25.56222146040450,-25.025139984001800,-24.802308307622000,-24.522340303965300,-24.019540623928700,-23.276768369329200,-23.20249114386930,-22.768255056564900,-22.276882641983800,-22.276882641983800]]

tantalumx=[-0.2591670499881080,70.80200389108540,133.19647117572000,207.43351237576400,258.85007150361600,340.59561885977200,476.64274860259200,546.2521903016400,569.935190339226,584.9527395997590,594.7711973768290]
tantalumy=[10**x for x in [-28.052044609665400,-27.853779429987600,-27.63073110285010,-27.308550185873600,-27.048327137546500,-26.565055762081800,-25.561338289962800,-24.855018587360600,-24.50805452292440,-24.223048327137500,-23.987608426270100]]

plt.xlabel("$\delta$ [keV]",size=14)
plt.ylabel("$\sigma_p$ [cm$^2$]",size=14)

plt.yscale("log")
plt.ylim([10**-38,10**-22])
plt.xlim([0,850])

plt.plot(maxsigmadelta,maxsigma1km,"r--")
plt.fill_between(upscattereddeltajun24,upscatteredlimitjun24,1,facecolor="red",alpha=0.4)
plt.plot(upscattereddelta100dec21,upscatteredlimit100dec21,color="red",label="XENON100 (This Work)")
plt.fill_between(upscattereddelta100dec21,upscatteredlimit100dec21,1,facecolor="white",alpha=1)
plt.fill_between(upscattereddelta100dec21,upscatteredlimit100dec21,1,facecolor="red",alpha=0.4)
plt.fill_between(maxsigmadelta,maxsigma1km,1,facecolor="white",alpha=0.4)

plt.plot(upscattereddeltajun24,upscatteredlimitjun24,"r:",label="XENON1T (This Work)")

plt.plot(songdelta,songlimit,color="gray",label="Song et al.")
plt.plot(picolmcdelta,picolmclimit,"k-",label="PICO-60 (LMC)")
plt.plot(combineddddelta,combinedddlimit,"k--",label="CRESST-II + PICO-60 (SHM)")
plt.fill_between(picolmcdelta,picolmclimit,1,facecolor="gray",alpha=0.4)

plt.tick_params(direction="in",length=10,labelsize=14)
plt.tick_params(which="minor",direction="in",length=4)

plt.plot(tantalumx,tantalumy,"b-",label="Tantalum")
plt.fill_between(tantalumx,tantalumy,1,facecolor="blue",alpha=0.3)

plt.legend(loc=4,fontsize=9)
plt.tight_layout()
plt.savefig("inelasticxenonlimitslargedelta.pdf")
plt.show()
